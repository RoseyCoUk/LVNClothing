<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Grouping Toggle Fix</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            background: #f9fafb;
        }
        .container {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .test-section {
            border: 1px solid #e5e7eb;
            border-radius: 6px;
            padding: 15px;
            margin: 10px 0;
        }
        .pass { border-color: #10b981; background: #ecfdf5; }
        .fail { border-color: #ef4444; background: #fef2f2; }
        .info { border-color: #3b82f6; background: #eff6ff; }
        
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover { background: #2563eb; }
        
        .status { font-weight: bold; }
        .pass .status { color: #059669; }
        .fail .status { color: #dc2626; }
        .info .status { color: #2563eb; }
        
        pre {
            background: #f3f4f6;
            padding: 10px;
            border-radius: 4px;
            overflow-x: auto;
            font-size: 12px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px 0;
        }
        
        th, td {
            border: 1px solid #e5e7eb;
            padding: 8px;
            text-align: left;
        }
        
        th {
            background: #f9fafb;
            font-weight: 600;
        }
        
        .toggle-demo {
            display: inline-flex;
            height: 24px;
            width: 44px;
            items-center;
            border-radius: 9999px;
            background: #3b82f6;
            margin: 0 10px;
            position: relative;
        }
        
        .toggle-demo::after {
            content: '';
            display: block;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            background: white;
            position: absolute;
            right: 4px;
            transition: all 0.2s;
        }
    </style>
</head>
<body>
    <h1>üîß Grouping Toggle Fix Verification</h1>
    
    <div class="container">
        <h2>‚úÖ Issue Fixed</h2>
        <div class="test-section pass">
            <div class="status">PROBLEM IDENTIFIED & FIXED</div>
            <p>The grouping toggle wasn't appearing because the <code>hasColors</code> logic was checking for exact matches like 'cap', 'tshirt', 'hoodie' but your actual product names are probably something like "Reform UK T-Shirt".</p>
            
            <h3>What was changed:</h3>
            <ol>
                <li>Updated <code>hasColors</code> logic in <code>VariantManagement.tsx</code></li>
                <li>Updated <code>hasVariants</code> and <code>hasColors</code> logic in <code>EnhancedImageManagement.tsx</code></li>
                <li>Added debug logging to verify detection</li>
            </ol>
        </div>
    </div>

    <div class="container">
        <h2>üß™ Test Product Name Detection</h2>
        
        <div class="test-section info">
            <div class="status">TESTING: Old vs New Logic</div>
            <button onclick="runDetectionTest()">Test Product Name Detection</button>
            <div id="detectionResults"></div>
        </div>
    </div>

    <div class="container">
        <h2>üé® Expected Grouping Toggle Appearance</h2>
        
        <div class="test-section info">
            <div class="status">HOW THE TOGGLE SHOULD LOOK</div>
            <p>For products with color variants (T-shirts, Hoodies, Caps), you should see this toggle in the Variants tab header:</p>
            
            <div style="background: #f3f4f6; padding: 15px; border-radius: 6px; margin: 10px 0;">
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 14px; color: #374151;">Group by Color:</span>
                    <div class="toggle-demo"></div>
                    <span style="font-size: 14px; color: #6b7280;">On</span>
                </div>
            </div>
            
            <p><strong>Location:</strong> Top right of the Variants tab, next to the "Refresh" button</p>
        </div>
    </div>

    <div class="container">
        <h2>üìã How to Verify the Fix</h2>
        
        <div class="test-section info">
            <div class="status">VERIFICATION STEPS</div>
            <ol>
                <li>Open your React app and go to Admin ‚Üí Products</li>
                <li>Select a T-shirt, Hoodie, or Cap product</li>
                <li>Go to the "Variants" tab</li>
                <li>Look for the "Group by Color:" toggle in the top-right area</li>
                <li>Check the browser console for debug logs like: <code>üé® Color detection for "Product Name"</code></li>
            </ol>
            
            <p><strong>If you still don't see the toggle:</strong></p>
            <ul>
                <li>Check the console logs to see what product name is being detected</li>
                <li>Verify the product name contains words like "t-shirt", "hoodie", or "cap"</li>
                <li>The toggle only appears for products with color variants</li>
            </ul>
        </div>
    </div>

    <script>
        const sampleProductNames = [
            "Reform UK T-Shirt",
            "Reform UK Hoodie", 
            "Reform UK Cap",
            "Reform UK Tote Bag",
            "REFORM UK T-SHIRT",
            "reform uk hoodie",
            "T-Shirt Classic",
            "Hoodie Premium",
            "Baseball Cap",
            "Simple Mug",
            "Random Product"
        ];

        function runDetectionTest() {
            const resultsDiv = document.getElementById('detectionResults');
            
            // Old logic (broken)
            function oldLogic(productName) {
                const normalizedCategory = productName?.toLowerCase().replace(/\s+/g, '-');
                return ['cap', 'caps', 'tshirt', 'tshirts', 'hoodie', 'hoodies', 'tote', 'totes', 'tote-bags'].includes(normalizedCategory);
            }
            
            // New logic (fixed)
            function newLogic(productName) {
                const normalized = productName?.toLowerCase() || '';
                return normalized.includes('t-shirt') || 
                       normalized.includes('tshirt') || 
                       normalized.includes('hoodie') || 
                       normalized.includes('cap') || 
                       normalized.includes('tote');
            }
            
            let tableHTML = `
                <h3>Detection Test Results</h3>
                <table>
                    <thead>
                        <tr>
                            <th>Product Name</th>
                            <th>Old Logic</th>
                            <th>New Logic</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
            `;
            
            sampleProductNames.forEach(productName => {
                const oldResult = oldLogic(productName);
                const newResult = newLogic(productName);
                const status = newResult ? '‚úÖ Will show toggle' : '‚ùå No toggle';
                const rowClass = newResult ? 'pass' : 'fail';
                
                tableHTML += `
                    <tr class="${rowClass}">
                        <td><strong>"${productName}"</strong></td>
                        <td>${oldResult ? '‚úÖ Pass' : '‚ùå Fail'}</td>
                        <td>${newResult ? '‚úÖ Pass' : '‚ùå Fail'}</td>
                        <td>${status}</td>
                    </tr>
                `;
            });
            
            tableHTML += `
                    </tbody>
                </table>
                <p><strong>Summary:</strong> The new logic correctly detects products that should have the grouping toggle!</p>
            `;
            
            resultsDiv.innerHTML = tableHTML;
        }
    </script>
</body>
</html>
